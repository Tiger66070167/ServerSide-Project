<header>
  <nav>
    <ul>
      <li><a href="/">Homepage</a></li>
      <li><a href="/about">About Us</a></li>
    </ul>
  </nav>

  <!-- ========== PROFILE DROPDOWN SECTION ========== -->
  <div class="profile-dropdown">
    <div class="profile-trigger" onclick="toggleDropdown()">
      <!-- แสดงรูปโปรไฟล์ ถ้าไม่มีให้ใช้รูป default-avatar.png -->
      <img 
        src="<%= (typeof user !== 'undefined' && user.avatar_url) 
                ? user.avatar_url + '?v=' + new Date().getTime() 
                : '/images/default-avatar.png' %>" 
        alt="User Avatar" 
        class="avatar"
      >
      
      <span class="username"><%= username %></span>
      
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
      </svg>
    </div>
    <div class="dropdown-menu" id="profileDropdownMenu">
      <a href="/settings" class="dropdown-item">Settings</a>
      <a href="/logout" class="dropdown-item logout">Logout</a>
    </div>
  </div>
</header>

<!-- ========== JAVASCRIPT FOR DROPDOWN ========== -->
<script>
  function toggleDropdown() {
    document.getElementById("profileDropdownMenu").classList.toggle("show");
  }

  window.onclick = function(event) {
    if (!event.target.closest('.profile-trigger')) {
      const dropdowns = document.getElementsByClassName("dropdown-menu");
      for (let i = 0; i < dropdowns.length; i++) {
        const openDropdown = dropdowns[i];
        if (openDropdown.classList.contains('show')) {
          openDropdown.classList.remove('show');
        }
      }
    }
  }
</script>
